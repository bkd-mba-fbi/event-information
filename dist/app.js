var A=a=>typeof a=='string',b='evtToken',c=window.eventInformation.settings,e=p('buildingId'),f=p('instance'),g=p('roomId'),h=p('refresh'),i=p('color'),j=p('headerColor'),k=p('siteChange'),l=null,m=0;let d=navigator.language.split('-')[0]=='fr'?'fr-CH':'de-CH';function n(B){sessionStorage.setItem(b,B)}function o(){let C=sessionStorage.getItem(b);return C!==void 0?C:null}function p(_a,_b){!A(_b)&&(_b=window.location.href);_a=_a.replace(/[[\]]/g,'\\url');var _c=RegExp(`[?&]${_a}(=([^&#]*)|&|#|$)`),D=_c.exec(_b);if(!D)return null;if(!D[2])return'';return decodeURIComponent(D[2].replace(/\+/g,' '))}function q(){let _A=o();let _B=_A==null?null:_(_A).exp*1000;if(_A==null||(_B!==null&&Date.now()>=_B))return!1;let _C=_(_A);return f==_C.instance_id&&_C.culture_info==d}function _(E){return JSON.parse(atob(E.split('.')[1]))}function s(){let aA=p('access_token');aA!==null&&(n(aA),location.href.indexOf('?access_token')>0?location.replace(location.href.split('?')[0]):location.replace(location.href.substring(0,location.href.indexOf('&access_token'))))}function t(){if(q())return Promise.resolve();location.replace(`${c.authUrl}/Authorization/${f}/Token?clientId=${c.clientId}&redirectUrl=${location.href}&culture_info=${d}&application_scope=Public`);return new Promise(()=>{})}function u(){k=k>0?k*1000:3500;setInterval(()=>{m=document.getElementById('events').getBoundingClientRect().height<=m?0:(m+screen.availHeight)-document.getElementById('header').getBoundingClientRect().height;window.scrollTo(0,m)},k)}async function v(aB){var aC=await fetch(aB,{method:'GET',headers:{'CLX-Authorization':'token_type=urn:ietf:params:oauth:token-type:jwt-bearer, access_token='+o()}});return aC.json()}function w(){t();let aD=new Date();let aE=`${aD-(60000*5)}`;let aF=`${aD.setHours(23)}`;aE=aE.substring(0,10);aF=aF.substring(0,10);v(c.restUrl+`/RoomReservation/Rooms/Occupancies/?filter.DateTimeFrom=${aE}&filter.DateTimeTo=${aF}&sort=DateTimeFrom.asc`).then(aG=>{var aH=document.getElementById('events');for(const aJ of document.querySelectorAll('tr')){console.log();aJ.remove()}for(const aK of aG){var aI=i==null?aK.DisplayColor:`#${i}`,_d=l.filter(r=>r.Id==aK.ResourceId);console.log(aI);if(_d.length>0&&aI==aK.DisplayColor){var _e=aH.insertRow(),F=_e.insertCell(0),G=_e.insertCell(1);F.innerHTML=aK.DateTimeFrom.split('T')[1].substring(0,5)+' - '+aK.DateTimeTo.split('T')[1].substring(0,5);F.classList.add('medium');G.innerHTML=aK.Designation;G.classList.add('large');if(l.length>1){var H=_e.insertCell(2),I=_e.insertCell(3);H.classList.add('small');H.innerHTML=_d[0].Floor;I.classList.add('small');I.innerHTML=aK.Ressource}document.getElementById('events').style.marginTop=document.getElementById('header').getBoundingClientRect().height+'px'}}})}(e==null||g==null)&&f==null?window.alert('Param instanceId and buildingId or roomId must be set: '+location.host+'?instance={id}&buildingId={id} to url'):s();
